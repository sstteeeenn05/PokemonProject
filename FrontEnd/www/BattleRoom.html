<html>
<head>
	<meta charset="UTF-8">
	<title>Battle</title>
	<link rel="stylesheet" href="BattleRoom.css">
	<link rel="stylesheet" href="modal.css">
	<script defer src="BattleRoom.js" type="module"></script>
</head>
<body x-data x-cloak>
<div class="upper-div" x-show="$store.loading.isLoading">
	<div class="upper"></div>
	<div class="middle-upper"></div>
</div>
<div class="lower-div" x-show="$store.loading.isLoading">
	<div class="middle-lower"></div>
	<div class="lower"></div>
</div>

<div class="main" x-show="$store.loading.canMainShow">
	<div class="enemy"  :class="{'damaged' :$store.game.isDamaged[1]}">
		<img class="enemy-pokemon-img" draggable="false" :src="$store.game.constData.enemy[$store.game.enemyId].src">
	</div>
	<img class="enemy-cover" draggable="false" src="./assets/Pokeball.png" :class="{'changing' :$store.game.isChanging[1]}">

	<div class="player" :class="{'damaged' :$store.game.isDamaged[0]}">
		<img class="player-pokemon-img"  draggable="false" :src="$store.game.constData.player[$store.game.playerId].src">
	</div>
	<img class="player-cover" draggable="false" src="./assets/Pokeball.png" :class="{'changing' :$store.game.isChanging[0]}">

	<div class="enemy-info" :style="{
		'--health-width':$store.game.dynamicData.enemy[$store.game.enemyId].hp/$store.game.constData.enemy[$store.game.enemyId].hp*100+'%',
		'--color-value':$store.game.dynamicData.enemy[$store.game.enemyId].hp/$store.game.constData.enemy[$store.game.enemyId].hp*255
	}">
		<div class="info-upper">
			<div class="pokemon-name-section">
				<span class="pokemon-name" id="enemy-pokemon-name" x-text="$store.game.constData.enemy[$store.game.enemyId].name"></span>
				<template x-for="(icon, index) in $store.game.constData.enemy[$store.game.enemyId].types" :key="index">
					<img class="icon" draggable="false" :src="'./assets/' + icon + '.png'">
				</template>
				<span class="level" x-text="'lv'+$store.game.dynamicData.enemy[$store.game.enemyId].level"></span>
			</div>

			<div class="icons">
				<template x-for="(icon, index) in $store.game.dynamicData.enemy[$store.game.enemyId].cons" :key="index">
					<img class="icon" draggable="false" :src="'./assets/' + icon + '.svg'">
				</template>
			</div>
		</div>

		<div class="health-bar">
			<div class="pokemon-health-out">
				<div class="pokemon-health-in"></div>
			</div>
			<span class="health" x-text="$store.game.dynamicData.enemy[$store.game.enemyId].hp+'/'+$store.game.constData.enemy[$store.game.enemyId].hp"></span>
		</div>
	</div>

	<div class="player-info" :style="{
		'--health-width':$store.game.dynamicData.player[$store.game.playerId].hp/$store.game.constData.player[$store.game.playerId].hp*100+'%',
		'--color-value':$store.game.dynamicData.player[$store.game.playerId].hp/$store.game.constData.player[$store.game.playerId].hp*255
	}">
		<div class="info-upper">
			<div class="pokemon-name-section">
				<span class="pokemon-name" id="player-pokemon-name" x-text="$store.game.constData.player[$store.game.playerId].name"></span>
				<template x-for="(icon, index) in $store.game.constData.player[$store.game.playerId].types" :key="index">
					<img class="icon" draggable="false" :src="'./assets/' + icon + '.png'">
				</template>
				<span class="level" x-text="'lv'+$store.game.dynamicData.player[$store.game.playerId].level"></span>
			</div>

			<div class="icons">
				<template x-for="(icon, index) in $store.game.dynamicData.player[$store.game.playerId].cons" :key="index">
					<img class="icon" draggable="false" :src="'./assets/' + icon '.svg'">
				</template>
			</div>
		</div>
		<div class="health-bar">
			<div class="pokemon-health-out">
				<div class="pokemon-health-in"></div>
			</div>
			<span class="health" x-text="$store.game.dynamicData.player[$store.game.playerId].hp+'/'+$store.game.constData.player[$store.game.playerId].hp"></span>
		</div>
	</div>
	<div class="move-menu">
		<span class="context" x-text="$store.game.queue[0][0]" @click="$store.game.message" style="cursor:pointer"></span>
		<div class="move-section">
				<button class="move-button" @click="$store.modal.open('fight'); $store.loading.buttonSound.play();">Fight</button>
				<button class="move-button" @click="$store.modal.open('bag'); $store.loading.buttonSound.play();">Bag</button>
				<button class="move-button" @click="$store.modal.open('pokemon'); $store.loading.buttonSound.play();">Pok√©mon</button>
				<button class="move-button" @click="location.href = '/'; $store.loading.buttonSound.play();">Exit</button>
		</div>
	</div>
</div>

<dialog class="modal" id="list">
	<div class="data-list">

		<div class="fight-selection-section" x-show="$store.modal.type === 'fight'">
			<template x-for="(move,index) in $store.game.constData.player[0].moves" :key="index">
				<div class="fight-data">
					<div class="skill-title">
						<h2 x-text="move.name" style="margin: 0; display: inline-block"></h2>
						<div>
							<img class="icon" draggable="false" :src="'./assets/' + move.type + '.png'">
						</div>
					</div>
					<div class="skill-description">
						<div class="condition-list" x-show="move.con">
							<span style="font-size: x-large; margin-right: 2px">Con:</span>
							<img class="icon" draggable="false" :src="'./assets/' + move.con + '.svg'">
						</div>
						<div class="skill-detail">
							<span class="skill-form" x-text="move.type=='Potion'?'Potion':move.isPhysical?'Physical':'Special'"></span>
							<span class="skill-point" x-text="'PP: '+$store.game.dynamicData.player[0].moves[index].pp+'/'+move.pp"></span>
						</div>
					</div>
				</div>
			</template>
		</div>

		<div x-show="$store.modal.type === 'bag'">
			<template x-for="(item, index) in $store.modal.potionList" :key="index">
				<table class="potion-table" @click="$store.modal.selectingPokemon()">
					<tr>
						<td class="Potion-data-img-container">
							<img class="potion-data-img" draggable="false" :src="'./assets/' + item[0]">
						</td>
						<td>
							<div class="potion-data">
								<h1 x-text="item[1]" style="margin-top: 0"></h1>
								<span x-text="item[2]" style="font-size: x-large"></span>
							</div>
						</td>
					</tr>
				</table>
			</template>
		</div>

		<div x-show="$store.modal.type === 'pokemon'">
			<template x-for="(pokemon,index) in $store.game.dynamicData.player" :key="index">
				<table class="pokemon-table">
					<tr>
						<td class="pokemon-data-img-container">
							<img class="pokemon-data-img" :src="$store.game.constData.player[index].src" draggable="false">
						</td>
						<td>
							<div class="pokemon-data">
								<div class="pokemon-data-upper">
									<div class="pokemon-name-section">
										<span class="pokemon-name" x-text="pokemon.name"></span>
										<template x-for="(icon, index) in pokemon.types" :key="index" x-show="pokemon.types">
											<img class="icon" draggable="false" :src="'./assets/' + icon + '.png'" >
										</template>
										<span class="level" x-text="'lv'+pokemon.level"></span>
									</div>
									<div class="icons">
										<template x-for="(icon, index) in pokemon.cons" :key="index" x-show="pokemon.cons">
											<img class="icon" draggable="false" :src="'./assets/' + icon + '.png'">
										</template>
									</div>
								</div>
								<div class="health-bar pokemon-data-health-bar">
									<div class="pokemon-health-out pokemon-data-health-out">
										<div class="pokemon-health-in"></div>
									</div>
									<span class="health pokemon-data-health" x-text="pokemon.hp+'/'+$store.game.constData.player[index].hp"></span>
								</div>
							</div>
						</td>
					</tr>
				</table>
			</template>
		</div>

	</div>
	<button class="modal-button cancel close" @click="$store.modal.close(); $store.loading.buttonSound.play();">cancel</button>
</dialog>

</body>
</html>